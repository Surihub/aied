<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css">
    <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
    <link href="style/style.css" rel="stylesheet">

    <title>ê±°ë¶ì´ ë¯¸ë¡œ íƒˆì¶œ(Q-learning ì‹¤ìŠµ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div id="header"></div>
    <div class="container my-5">
        <div class="bg-white shadow-lg rounded-lg custom-padding">
            <!-- Left Column for Text -->
            <div class="row">
                <div class="col-md-8">
                    <h2>ê±°ë¶ì´ ë¯¸ë¡œ íƒˆì¶œ</h2>
                    <b>í•™ìŠµ ëª©í‘œ : </b> ê±°ë¶ì´ ë¯¸ë¡œ íƒˆì¶œ ì˜ˆì œë¥¼ í†µí•œ Q-learning í•™ìŠµ <br>
                    <b>ëŒ€ìƒ í•™ë…„ : </b> ê³ ë“±í•™êµ 1~2í•™ë…„ <br><br>
                    
                    <h4>ğŸ’¡ í•™ìŠµ ë‚´ìš©</h4>
                    1. ê°•í™”í•™ìŠµì˜ ê¸°ë³¸ ìš©ì–´ <br>
                    2. Q-learning ì´ë€? <br>
                    3. Pythonì„ ì´ìš©í•œ Q-learning ì‹¤ìŠµ <br><br>
                </div>
                <div class="col-md-4">
                    <img src="/image/turtle.png" alt="Relevant Description" style="width: 100%;">
                </div>
            </div>
        </div>
    </div>






    <py-env>
        - numpy
        - pandas
        - matplotlib
    </py-env>

    <div class = "container mx-auto px-4 py-8">
        <h2 class="text-3xl font-bold text-center mb-4">ê°•í™”í•™ìŠµì˜ ê¸°ë³¸ ìš©ì–´</h2>
        <div class="bg-white shadow rounded-lg p-6">
                    <p class="text-lg">
<b> ê°•í™”í•™ìŠµì´ë€? : </b><b>ì—ì´ì „íŠ¸</b>ê°€ í˜„ì¬ì˜ <b>ìƒíƒœ</b>ì—ì„œ <b>í–‰ë™</b>ì„ í•˜ê³ , í–‰ë™ì— ëŒ€í•œ <b>ë³´ìƒ</b>ì„ ë°›ìœ¼ë©° ìµœì ì˜ ì •ì±…ì„ ì°¾ì•„ê°€ëŠ” í•™ìŠµì´ë‹¤.
<br><br>
<b> ì—ì´ì „íŠ¸ : </b> í•™ìŠµí•˜ëŠ” ëŒ€ìƒì„ ì˜ë¯¸í•œë‹¤. (ê±°ë¶ì´) <br>
<b> ìƒíƒœ : </b> ì—ì´ì „íŠ¸ê°€ ì²˜í•œ ìƒí™©ì´ë‹¤. (ë¯¸ë¡œ ì•ˆ ê±°ë¶ì´ì˜ ìœ„ì¹˜) <br>
<b> í–‰ë™ : </b> ì—ì´ì „íŠ¸ê°€ ì²˜í•œ ìƒí™©ì— ëŒ€ì‘í•˜ì—¬ í–‰ë™í•œë‹¤. (ê±°ë¶ì´ì˜ ìƒ,í•˜,ì¢Œ,ìš° ì›€ì§ì„) <br>
<b> ë³´ìƒ : </b> ì—ì´ì „íŠ¸ê°€ í–‰ë™ì— ëŒ€í•´ ë³´ìƒì„ ë°›ëŠ”ë‹¤. ë¶€ì •ì ì¸ ë³´ìƒ, ê¸ì •ì ì¸ ë³´ìƒ ëª¨ë‘ ì¡´ì¬í•œë‹¤. (ë¯¸ë¡œ íƒˆì¶œ ì‹œ ê¸ì •ì ì¸ ë³´ìƒ) <br>
<b> ì—í”¼ì†Œë“œ : </b> ì‹œì‘í•˜ê³  ëë‚ ë•Œê¹Œì§€ì˜ ì—ì´ì „íŠ¸ì˜ ìƒíƒœì™€ í–‰ë™ì„ ì˜ë¯¸í•œë‹¤. (ê±°ë¶ì´ê°€ ë¯¸ë¡œë¥¼ íƒˆì¶œí•  ë•Œê¹Œì§€ ì§€ë‚˜ê°„ ìœ„ì¹˜ì™€ ìœ„ì¹˜ì—ì„œ ê±°ë¶ì´ê°€ ì´ë™í•œ ë°©í–¥)<br>
                    </p>
        </div>
    </div>
    <div class = "container mx-auto px-4 py-8">
        <h2 class="text-3xl font-bold text-center mb-4">Q-learningì´ë€?</h2>
        <div class="bg-white shadow rounded-lg p-6">
                    <p class="text-lg">
<b> Q-value : </b> ì—ì´ì „íŠ¸ê°€ ì²˜í•œ ìƒíƒœì—ì„œ í–‰ë™ì— ë”°ë¥¸ ì˜ˆìƒ ë³´ìƒì„ ìˆ˜ì¹˜ë¡œ ë‚˜íƒ€ë‚¸ ê°’ì´ë‹¤. <br>
<b> Q-learning : </b> ì—¬ëŸ¬ë²ˆì˜ ì—í”¼ì†Œë“œë¥¼ í†µí•´ Q-valueë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•™ìŠµ ë°©ë²•ì´ë‹¤. í•™ìŠµì´ ì™„ë£Œëœ ì´í›„ ìƒíƒœì— ë”°ë¼ Q-valueê°€ ê°€ì¥ ë†’ì€ í–‰ë™ì„ ì·¨í•œë‹¤. <br>
<b> Q-table : </b> ìƒíƒœì™€ í–‰ë™ì— ëŒ€í•œ Q-valueìœ¼ë¡œ ì´ë£¨ì–´ì§„ í‘œë‹¤. <br>
<b> epsilon greedy : </b> ì—ì´ì „íŠ¸ê°€ í–‰ë™ì„ ê²°ì •í•  ë•Œ Q-valueê°€ ê°€ì¥ ë†’ì€ í–‰ë™ìœ¼ë¡œ ê²°ì •í•œë‹¤. epsilon ë³€ìˆ˜ë¥¼ í†µí•´ ì¼ì • í™•ë¥  ë§Œí¼ ì—ì´ì „íŠ¸ê°€ ëœë¤ìœ¼ë¡œ í–‰ë™ì„ ê²°ì •í•˜ê²Œ í•œë‹¤. <br>                
                    </p>
        </div>
    </div>
    <!--- ë¯¸ë¡œ ê·¸ë¦¬ê¸° -->
    <div class="container mx-auto px-4 py-8">
        <h2 class="text-3xl font-bold text-center mb-4">ë¯¸ë¡œ ê·¸ë¦¬ê¸°</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="bg-white shadow rounded-lg p-6">
                <p class="text-lg">
<b> ë¯¸ë¡œì˜ ê·œì¹™ </b> <br> <br>
1. ë¯¸ë¡œëŠ” ê°€ë¡œ ì„¸ë¡œ ê¸¸ì´ê°€ 1ì¸ ë°•ìŠ¤ 25ê°œ(ê°€ë¡œ 5ì¹¸, ì„¸ë¡œ 5ì¹¸)ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤. <br>
2. ê±°ë¶ì´ëŠ” 0ë²ˆ ë°•ìŠ¤ì—ì„œ ì‹œì‘í•œë‹¤. <br>
3. ê±°ë¶ì´ëŠ” í•œ ë²ˆì— í•œ ë°•ìŠ¤ë§Œ ì´ë™ ê°€ëŠ¥í•˜ë‹¤. <br>
4. ë°•ìŠ¤ ì‚¬ì´ì— ë¹¨ê°„ ë²½ì´ ìˆëŠ” ê²½ìš°ì— ê±°ë¶ì´ëŠ” ê·¸ ë²½ì„ ë„˜ì–´ì„œ ì´ë™í•  ìˆ˜ ì—†ë‹¤. <br>
5. ê±°ë¶ì´ê°€ íƒˆì¶œ ì¥ì†Œ(GOAL)ì— ë„ì°©í•˜ë©´ ë¯¸ë¡œë¥¼ íƒˆì¶œí•œë‹¤. <br> <br>

<b> íŒŒì´ì¬ì„ ì´ìš©í•˜ì—¬ ë¯¸ë¡œ ì‹œê°í™”í•˜ê¸° </b> <br> <br>
íŒŒì´ì¬ì˜ matplotlib.pylotì„ ì´ìš©í•˜ì—¬ ì¢Œí‘œ í‰ë©´ ìœ„ì— ê±°ë¶ì´ê°€ íƒˆì¶œí•  ë¯¸ë¡œë¥¼ ê·¸ë¦´ ìˆ˜ ìˆë‹¤.<br>
ë¯¸ë¡œì˜ ì™¼ìª½ ì•„ë˜ ê¼­ì§“ì ì„ (0,0)ìœ¼ë¡œ ìƒê°í•˜ë©´ ëœë‹¤.<br><br>

<b> (ì‹¬í™”) ìê¸°ë§Œì˜ ë¯¸ë¡œ ë§Œë“¤ê¸° </b> <br> <br>
ì œê³µëœ ë¯¸ë¡œë§Œì„ ì‚¬ìš©í•˜ê³  ì‹¶ì€ ê²½ìš° ì½”ë“œë¥¼ ìˆ˜ì •í•  í•„ìš”ëŠ” ì—†ë‹¤. <br>
ìê¸°ë§Œì˜ ë¯¸ë¡œë¥¼ ë§Œë“¤ì–´ ì‹¤ìŠµì„ ì§„í–‰í•˜ê³  ì‹¶ë‹¤ë©´, ì½”ë“œì˜ ì£¼ì„ ì¤‘ (ì»¤ìŠ¤í„°ë§ˆì´ì§•)ì´ë¼ê³  ì í˜€ ìˆëŠ” ë¶€ë¶„ì„ ì°¸ê³ í•˜ë©´ ëœë‹¤. <br>
(ì»¤ìŠ¤í„°ë§ˆì´ì§•)ì´ ì íŒ ë¶€ë¶„ì€ ìê¸°ë§Œì˜ ë¯¸ë¡œë¥¼ ë§Œë“¤ë•Œ í™œìš©ë˜ëŠ” ì½”ë“œë¡œ, ê° ë¶€ë¶„ì˜ ì»¤ìŠ¤í„°ë§ˆì´ì§• ë°©ë²•ì€ ì£¼ì„ì— ì í˜€ìˆë‹¤.
                </p>
        </div>
        <div class="max-w-sm rounded overflow-hidden shadow-lg">
            <p class="text-lg"><b>ë¯¸ë¡œ ì˜ˆì‹œ</b><br></p>
            <img class="w-full" src="image/example.png" alt="Maze Example">
        </div>
        </div>
    </div>
    <div id="headers"></div>
    <py-repl id="import-package">
import numpy as np
import matplotlib.pyplot as plt
    </py-repl>
    <py-repl id="draw-maze">
fig = plt.figure(figsize=(5, 5))
ax = plt.gca()
        
# ê°€ë¡œ ì„¸ë¡œê°€ 5ì¹¸ì¸ ë¯¸ë¡œ ë§Œë“¤ê¸°        
for j in range(5,0,-1):
    for i in range(5):
        plt.text(i+0.5, j-0.5, f"{5*(5-j)+i}", size=14, ha='center')
        
# ì‹œì‘ ì§€ì (START)ê³¼ íƒˆì¶œ ì¥ì†Œ(GOAL) ë§Œë“¤ê¸°
plt.text(0.5, 4.3, 'START', ha='center')
plt.text(4.5, 0.3, 'GOAL', ha='center') 
        
"""
(ì»¤ìŠ¤í„°ë§ˆì´ì§•)ë¶‰ì€ ë²½ ê·¸ë¦¬ê¸° 
(x1, y1)ê³¼ (x2,y2)ë¥¼ ì—°ê²°í•˜ëŠ” ë²½ì„ ê·¸ë¦¬ëŠ” ë°©ë²• : 
plt.plot([x1, x2], [y1, y2], color='red', linewidth=2)
"""
plt.plot([1, 5], [4, 4], color='red', linewidth=2)
plt.plot([1, 1], [1, 4], color='red', linewidth=2)
plt.plot([1, 3], [1, 1], color='red', linewidth=2)
plt.plot([1, 2], [3, 3], color='red', linewidth=2)
plt.plot([4, 4], [0, 3], color='red', linewidth=2)
plt.plot([2, 4], [2, 2], color='red', linewidth=2)
plt.plot([3, 4], [3, 3], color='red', linewidth=2)
        
# ê·¸ë¦¼ì„ ê·¸ë¦´ ë²”ìœ„ ë° ëˆˆê¸ˆ ì œê±° ì„¤ì •
ax.set_xlim(0, 5)
ax.set_ylim(0, 5)
plt.tick_params(axis='both', which='both', bottom=False, top=False,
                labelbottom=False, right=False, left=False, labelleft=False)
                
# S0ì— ë…¹ìƒ‰ ì›ìœ¼ë¡œ í˜„ì¬ ìœ„ì¹˜ë¥¼ í‘œì‹œ
line, = ax.plot([0.5], [4.5], marker="o", color='g', markersize=45)
fig
    </py-repl>

    <div class="container mx-auto px-4 py-8">
        <h2 class="text-3xl font-bold text-center mb-4">ë¯¸ë¡œ íƒˆì¶œ ê²½ë¡œ ì‹œê°í™”í•˜ê¸°</h2>
        <div class="bg-white shadow rounded-lg p-6">
                <p class="text-lg">
<b> ë¯¸ë¡œ íƒˆì¶œ ê²½ë¡œë¥¼ ì‹œê°í™” í•˜ëŠ” ë°©ë²• </b> <br> <br>
1. íƒˆì¶œ ì¥ì†Œì— í•´ë‹¹í•˜ëŠ” ë°•ìŠ¤ë¥¼ í´ë¦­í•œë‹¤. <br>
2. ìœ„ì—ì„œ íŒŒì´ì¬ ì½”ë“œë¡œ ê·¸ë¦° ë¯¸ë¡œì— ë§ê²Œ ë¯¸ë¡œ ì•ˆì— ë¹¨ê°„ ë²½ì„ ì„¸ì›Œì¤€ë‹¤. ë°•ìŠ¤ì˜ ë³€ì„ ëˆ„ë¥¸ë‹¤ë©´ ë¹¨ê°„ ë²½ì´ ë§Œë“¤ì–´ì§„ë‹¤. <br>
3. ê±°ë¶ì´ì˜ íƒˆì¶œ ê²½ë¡œë¥¼ ìˆ«ìë¡œ ë‚˜ì—´í•œë‹¤. ìˆ«ì ì‚¬ì´ì—ëŠ” ì‰¼í‘œ(",")ë¥¼ ë„£ì–´ì¤€ë‹¤. (ì˜ˆì‹œ : 1, 2, 3) <br>
4. <b>ê±°ë¶ì´ ì´ë™ ì‹œì‘!</b> ë²„íŠ¼ì„ ëˆ„ë¥¸ë‹¤ë©´ ê±°ë¶ì´ê°€ ì´ë™í•˜ëŠ” ê²½ë¡œë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. <br> <br>

1ê³¼ 2ë¥¼ í•˜ë‹¤ê°€ ì˜ëª» ë§Œë“¤ê±°ë‚˜, ìƒˆë¡œìš´ ë¯¸ë¡œë¥¼ ë§Œë“¤ê³  ì‹¶ì„ ë•ŒëŠ” <b>ë¹¨ê°„ ë²½ ì§€ìš°ê¸°</b>, <b>íƒˆì¶œ ì¥ì†Œ ì§€ìš°ê¸°</b>ë¥¼ í´ë¦­í•˜ë©´ ë©ë‹ˆë‹¤. <br><br>
<span class="red-text"><b>ìƒˆë¡œê³ ì¹¨í•˜ë©´ ë¯¸ë¡œì—ì„œ ë³€ê²½ëœ ë‚´ìš©ì´ ì‚¬ë¼ì§€ë‹ˆ ìƒˆë¡œê³ ì¹¨í•˜ì§€ë§ˆì„¸ìš”!!</b></span>
                </p>
        </div>
    </div>

    <div class="max-w-2xl mx-auto my-10 p-5" id="interactive-maze">
        <div class="grid grid-cols-5 gap-4 relative">
            <!-- Boxes -->
            <!-- Using a loop to generate boxes -->
            <script>
              for (let i = 0; i < 25; i++) {
                document.write(`<div class="box border-2 border-dashed border-gray-400 p-4 text-center cursor-pointer" id="cell-${i}" onclick="markGoal(this)">${i}</div>`);
              }
            </script>
        </div>
        <div class="mt-6">
            <input type="text" id="numberInput" placeholder="ì´ë™ ê²½ë¡œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”" class="w-full p-2 border-2 border-gray-300 rounded-md focus:outline-none focus:border-blue-500" />
        </div>
        <div class="flex space-x-4 mt-4">
        <button id="startButton" class="px-6 py-2 border rounded text-white bg-blue-500 hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
            ê±°ë¶ì´ ì´ë™ ì‹œì‘!
        </button>
        <button id="clearred" class="px-6 py-2 border rounded text-white bg-green-500 hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50">
            ë¹¨ê°„ ë²½ ì§€ìš°ê¸°
        </button>
        <button id="cleargoal" class="px-6 py-2 border rounded text-white bg-green-500 hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50">
            íƒˆì¶œ ì¥ì†Œ ì§€ìš°ê¸°
        </button>
        </div>
    </div>
      
    <script>
        document.getElementById('startButton').addEventListener('click', function() {
          const input = document.getElementById('numberInput').value;
          const sequence = input.split(',').map(num => parseInt(num.trim(), 10));
          sequence.forEach((number, index) => {
            setTimeout(() => {
              const cell = document.getElementById(`cell-${number}`);
              if (cell) {
                cell.classList.add('highlight');
                setTimeout(() => cell.classList.remove('highlight'), 900);
              }
            }, index * 1000);
          });
        });

        
        document.getElementById('clearred').addEventListener('click', function() {
            for (let i = 0; i < 25; i++) {
                const cell = document.getElementById(`cell-${i}`);
                cell.style.borderLeft = '2px dashed #9CA3AF';
                cell.style.borderTop = '2px dashed #9CA3AF';
                cell.style.borderBottom = '2px dashed #9CA3AF';
                cell.style.borderRight = '2px dashed #9CA3AF';
            }
        });

        document.getElementById('cleargoal').addEventListener('click', function() {
            for (let i = 0; i < 25; i++) {
                const cell = document.getElementById(`cell-${i}`);
                cell.innerHTML = i;
                cell.classList.remove('goal');
            }
        });

        function markGoal(element) {
            const box = element;
            const rect = box.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            const tolerance = 10; // Edge click tolerance

            // Check if click is near the edges
            if (x < tolerance) {
            box.style.borderLeft = '2px solid red';
            } else if (x > rect.width - tolerance) {
            box.style.borderRight = '2px solid red';
            } else if (y < tolerance) {
            box.style.borderTop = '2px solid red';
            } else if (y > rect.height - tolerance) {
            box.style.borderBottom = '2px solid red';
            } else {
            element.classList.toggle('goal');
            element.textContent = element.classList.contains('goal') ? 'íƒˆì¶œ ì¥ì†Œ' : element.textContent;
            }

        }
    </script>
    <div class="container mx-auto px-4 py-8">
        <h2 class="text-3xl font-bold text-center mb-4">Q-table ë° í•¨ìˆ˜ ë§Œë“¤ê¸°</h2>
        <div class="bg-white shadow rounded-lg p-6">
                <p class="text-lg">
<b>Q_table : </b>ì´ˆê¸° Q-value ê°’ì´ë‹¤. <br>
<b>reward : </b>ë¯¸ë¡œ ì•ˆ ê° ìœ„ì¹˜ì— ëŒ€í•œ ë³´ìƒ ê°’ì´ë‹¤. <br>
<b>get_next_action : </b>Q-valueì— ê¸°ë°˜í•˜ì—¬ ìƒíƒœì— ë”°ë¥¸ í–‰ë™ì„ ê²°ì •í•˜ëŠ” í•¨ìˆ˜, 1-epsilon í™•ë¥  ë§Œí¼ ëœë¤ìœ¼ë¡œ í–‰ë™ì„ ê²°ì •í•œë‹¤. <br>
<b>get_next_location : </b>ìƒíƒœì— ë”°ë¥¸ í–‰ë™ì˜ ê²°ê³¼ ì´ë™í•  ìƒˆë¡œìš´ ìœ„ì¹˜ë¥¼ ì•Œë ¤ì£¼ëŠ” í•¨ìˆ˜ì´ë‹¤. <br>
<b>get_path : </b>ê±°ë¶ì´ì˜ íƒˆì¶œ ê²½ë¡œë¥¼ ì•Œë ¤ì£¼ëŠ” í•¨ìˆ˜ì´ë‹¤.
                </p>
        </div>
    </div>
    <py-repl id="define-theta0">
"""
(ì»¤ìŠ¤í„°ë§ˆì´ì§•) ì´ˆê¸° Q-tableì„ ì„¤ì •ì£¼ì.
- ê° ì¤„ì€ 0ë²ˆë¶€í„° 23ë²ˆ ë°•ìŠ¤ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.
- ì¤„ë§ˆë‹¤ 4ê°œì˜ ê°’ì´ ìˆìœ¼ë©°, ìˆœì„œëŒ€ë¡œ ìœ„, ì˜¤ë¥¸ìª½, ì•„ë˜, ì™¼ìª½ ë°©í–¥ìœ¼ë¡œì˜ ì´ë™ì— ëŒ€í•œ Q-valueì´ë‹¤.
- ì»¤ìŠ¤í„°ë§ˆì´ì§•ì„ í•˜ëŠ” ê²½ìš° ìœ„ì—ì„œ ë§Œë“  ë¯¸ë¡œì— ë§ì¶”ì–´ ì´ˆê¹ƒê°’ì„ ìˆ˜ì •í•˜ë©´ ëœë‹¤.
- ë¯¸ë¡œì˜ ê²½ê³„ë‚˜ ë¹¨ê°„ ë²½ì— ë§‰íŒ ë°©í–¥ì€ np.nanìœ¼ë¡œ ë†“ê³  ì´ë™ ê°€ëŠ¥í•œ ë°©í–¥ì€ 0ìœ¼ë¡œ ë†“ìœ¼ë©´ ëœë‹¤.
ì˜ˆì‹œ: 12ë²ˆì´ ì•„ë˜ ë°©í–¥ì´ ë§‰íˆê³  ë‚˜ë¨¸ì§€ ë°©í–¥ìœ¼ë¡œëŠ” ì´ë™ì´ ê°€ëŠ¥í•œ ê²½ìš°
12ë²ˆì§¸ ì¤„ì— [0, 0, np.nan, 0] ì…ë ¥
"""
Q_table = np.array([[np.nan, 0, 0, np.nan],  # 0
                    [np.nan, 0, np.nan, 0],  # 1
                    [np.nan, 0, np.nan, 0],  # 2
                    [np.nan, 0, np.nan, 0],  # 3
                    [np.nan, np.nan, np.nan, 0],  # 4
                    [0, np.nan, 0, np.nan],  # 5
                    [np.nan, 0, np.nan, np.nan],  # 6
                    [np.nan, 0, 0, 0],  # 7
                    [np.nan, 0, np.nan, 0],  # 8
                    [np.nan, np.nan, 0, 0],  # 9
                    [0, np.nan, 0, np.nan],  # 10
                    [np.nan, 0, 0, np.nan],  # 11
                    [0, 0, np.nan, 0],  # 12
                    [np.nan, np.nan, np.nan, 0],  # 13
                    [0, np.nan, 0, np.nan],  # 14
                    [0, np.nan, 0, np.nan],  # 15
                    [0, 0, np.nan, np.nan],  # 16
                    [np.nan, 0, np.nan, 0],  # 17
                    [np.nan, np.nan, 0, 0],  # 18
                    [0, np.nan, 0, np.nan],  # 19
                    [0, 0, np.nan, np.nan],  # 20
                    [np.nan, 0, np.nan, 0],  # 21
                    [np.nan, 0, np.nan, 0],  # 22
                    [0, np.nan, np.nan, 0],  # 23
                    [0, np.nan, np.nan, 0], #24
                    ])

# ë³´ìƒê°’ë“¤ì„ ì„¤ì •
# íƒˆì¶œ ì¥ì†ŒëŠ” 100, ë‚˜ë¨¸ì§€ëŠ” -1ë¡œ ì„¤ì •
rewards = -1 * np.ones(25)
rewards[-1] = 100
    </py-repl>
    <div class="container mx-auto px-4 py-8">
        <div class="bg-white shadow rounded-lg p-6">
                <p class="text-lg">
ë¯¸ë¡œ íƒˆì¶œì„ í•™ìŠµí•˜ì§€ ì•Šì€ ê²½ìš° ê±°ë¶ì´ê°€ ì–´ë–»ê²Œ ì›€ì§ì´ëŠ”ì§€ ê´€ì°°í•´ë´…ì‹œë‹¤.<br>
ì´ë•Œ, ê±°ë¶ì´ëŠ” ì´ë™ì´ ê°€ëŠ¥í•œ ë°©í–¥ ì¤‘ ëœë¤ìœ¼ë¡œ í•œ ë°©í–¥ì„ ê³¨ë¼ ì›€ì§ì¸ë‹¤.<br>
ì•„ë˜ì˜ ì½”ë“œ ì‹¤í–‰ ê²°ê³¼ì—ì„œ ëŒ€ê´„í˜¸([])ë¥¼ ì œì™¸í•œ ë¶€ë¶„ì„ ë³µì‚¬ í›„ <b>ë¯¸ë¡œ íƒˆì¶œ ê²½ë¡œ ì‹œê°í™”í•˜ê¸°</b>ì— ë¶™ì—¬ë„£ì–´ íƒˆì¶œ ê²½ë¡œë¥¼ ê´€ì°°í•´ë´…ì‹œë‹¤. <br><br>
<span class="red-text"><b>5ë²ˆì§¸ ì¤„ê³¼ 28ë²ˆì§¸ ì¤„ fixë¥¼ &lt;ë¡œ ìˆ˜ì •í•´ì£¼ì„¸ìš”</b></span>
                </p>
        </div>
    </div>           
    <py-repl id="define-functions">
# ë‹¤ìŒ í–‰ë™ì„ ê²°ì •í•´ì£¼ëŠ” í•¨ìˆ˜
# Q_valueê°€ ê°€ì¥ ë†’ì€ í–‰ë™ìœ¼ë¡œ ê²°ì •
# 1 - epsilonì˜í™•ë¥ ë¡œ ë‹¤ìŒ í–‰ë™ì„ ëœë¤í•˜ê²Œ ê²°ì • 
def get_next_action(current_box, epsilon):
    if np.random.random() fix epsilon: #nan ê°’ë“¤ì„ ë¬´ì‹œí•˜ê¸° ìœ„í•´ nanargmax ì‚¬ìš©
        return np.nanargmax(Q_table[current_box])
    else: # ì›€ì§ì¼ ìˆ˜ ìˆëŠ” ë°©í–¥ ì¤‘ í•˜ë‚˜ë¥¼ ëœë¤í•˜ê²Œ ì„ íƒ
        return np.random.choice(np.where(~np.isnan(Q_table[current_box]))[0])

# í˜„ì¬ ìœ„ì¹˜ì™€ í–‰ë™ì„ ê°€ì§€ê³  ë‹¤ìŒ ë‹¨ê³„ì˜ ìœ„ì¹˜ë¥¼ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜
def get_next_location(current_box, action_index):
    if action_index == 0: # ìœ„ë¡œ ì´ë™
        new_box = current_box - 5 
    elif action_index == 1: # ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™
        new_box = current_box + 1
    elif action_index == 2: # ë°‘ìœ¼ë¡œ ì´ë™
        new_box = current_box + 5
    elif action_index == 3: # ì™¼ìª½ìœ¼ë¡œ ì´ë™
        new_box = current_box - 1 
    return new_box

# íƒˆì¶œ ê²½ë¡œë¥¼ ì°¾ëŠ” í•¨ìˆ˜
def get_path():
    current_box = 0 # ë°•ìŠ¤ 0ì—ì„œ ì¶œë°œ
    shortest_path = [] # íƒˆì¶œ ê²½ë¡œë¥¼ ì €ì¥í•  ë¦¬ìŠ¤íŠ¸
    shortest_path.append(current_box)
    count = 0
    while current_box != 24 and count fix 30 : # 24ì— ë„ì°©í•˜ë©´ ë 30ë²ˆ ì´ë™í•˜ë©´ ë
        action_index = get_next_action(current_box, 1.) # ìµœì ì˜ ì„ íƒì„ í•´ì•¼í•˜ê¸°ì— epsilon = 1
        current_box = get_next_location(current_box, action_index)
        shortest_path.append(current_box)
        count += 1
    return shortest_path

# í•™ìŠµë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ ì›€ì§ì¸ ê²½ìš°
before_learn_path = get_path()
# ë¯¸ë¡œë¥¼ íƒˆì¶œí•˜ì§€ ëª»í•˜ê¸° ë•Œë¬¸ì— 30ì—ì„œ ëŠì–´ì£¼ê¸°
print(before_learn_path[:30])
    </py-repl>
    <div class="max-w-2xl mx-auto my-10 p-5">
    <div class="flex space-x-4 mt-4">
        <button id="moveButton1" class="px-6 py-2 border rounded text-white bg-blue-500 hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
            ë¯¸ë¡œ íƒˆì¶œ ê²½ë¡œ ì‹œê°í™”í•˜ê¸°ë¡œ ì´ë™
        </button>
    </div>
    </div>
    <script>
        document.getElementById('moveButton1').addEventListener('click', function() {
          const targetElement = document.getElementById("interactive-maze");
          targetElement.scrollIntoView({ behavior: 'smooth' });
        });
    </script>

    <div class="container mx-auto px-4 py-8">
        <h2 class="text-3xl font-bold text-center mb-4">Q-value ì—…ë°ì´íŠ¸ í•˜ëŠ” ë°©ë²•</h2>
        <div class="bg-white shadow rounded-lg p-6">
                <p class="text-lg">
Temporal Differencesë¥¼ í†µí•´ Q-valueë¥¼ ì—…ë°ì´íŠ¸ í•œë‹¤. <br>
(Temporal Difference) = (í–‰ë™ì— ë”°ë¥¸ ë³´ìƒ) + discount_factor * (ë‹¤ìŒ ìœ„ì¹˜ì˜ Q-value ì¤‘ ìµœëŒ“ê°’) - (old Q-value) <br>
(ìƒˆë¡œìš´ Q-value) = (old Q-value) + learning_rate * (Temporal Difference) <br>
í•œë²ˆ ì´ë™í• ë•Œë§ˆë‹¤ ìœ„ì˜ ì‹ì„ ì´ìš©í•´ì„œ Q-valueë¥¼ ì—…ë°ì´íŠ¸ í•œë‹¤. <br>
ì˜ˆë¥¼ ë“¤ì–´ ê±°ë¶ì´ê°€ 3ë²ˆ ë°•ìŠ¤ì—ì„œ ì™¼ìª½ìœ¼ë¡œ ê°”ë‹¤ë©´, ê±°ë¶ì´ê°€ ì´ë™í•¨ê³¼ ë™ì‹œì— 3ë²ˆ ë°•ìŠ¤ì˜ ì™¼ìª½ í–‰ë™ì— ëŒ€í•œ Q-valueê°€ ì—…ë°ì´íŠ¸ ëœë‹¤. 
                </p>
        </div>
    </div>
    <py-repl id="Q-learning">
"""
(ì»¤ìŠ¤í„°ë§ˆì´ì§•)
í•™ìŠµì˜ hyperparameter ì¡°ì •í•˜ê¸°
"""
epsilon = 0.9
discount_factor = 0.9
learning_rate = 0.9

for episode in range(100): # 100ë²ˆì˜ ì—í”¼ì†Œë“œ 
    current_box = 0 # ë°•ìŠ¤ 0ì—ì„œ ì¶œë°œ
    while current_box != 24: # 24ì— ë„ì°©í•˜ë©´ ë
        # í–‰ë™ ì •í•˜ê¸°
        action_index = get_next_action(current_box, epsilon)

        # í˜„ì¬ì˜ ìœ„ì¹˜ë¥¼ ë‹¤ë¥¸ ë³€ìˆ˜ëª…ì— ì €ì¥
        # ì´ë™í•  ìœ„ì¹˜ë¥¼ ì›ë˜ ë³€ìˆ˜ëª…ì— ì €ì¥
        old_box = current_box 
        current_box = get_next_location(current_box, action_index)
        
        # í–‰ë™ì— ë”°ë¼ ì´ë™í•  ìœ„ì¹˜ì— ëŒ€í•œ ë³´ìƒ
        reward = rewards[current_box]

        # Temporal Differencesë¥¼ ì´ìš©í•˜ì—¬ Q_table ì—…ë°ì´íŠ¸ í•˜ê¸°
        old_q_value = Q_table[old_box, action_index] # ì—…ë°ì´íŠ¸í•  q_value ê°€ì§€ê³  ì˜¤ê¸°
        temporal_difference = reward + (discount_factor * np.nanmax(Q_table[current_box])) - old_q_value # TDs ê³„ì‚°

        new_q_value = old_q_value + (learning_rate * temporal_difference) 
        Q_table[old_box, action_index] = new_q_value # ì—…ë°ì´íŠ¸í•˜ê¸°

    print(f'ì—í”¼ì†Œë“œ {episode} ì¢…ë£Œ')
    </py-repl>
    <py-repl id="shortest_path">
def get_shortest_path():
    current_box = 0 # ë°•ìŠ¤ 0ì—ì„œ ì¶œë°œ, ì›í•˜ëŠ” ì¶œë°œ ìœ„ì¹˜ë¡œ ì§€ì • ê°€ëŠ¥
    shortest_path = [] # íƒˆì¶œ ê²½ë¡œë¥¼ ì €ì¥í•  ë¦¬ìŠ¤íŠ¸
    shortest_path.append(current_box)
    while current_box != 24: # 24ì— ë„ì°©í•˜ë©´ ë
        action_index = get_next_action(current_box, 1.) # ìµœì ì˜ ì„ íƒì„ í•´ì•¼í•˜ê¸°ì— epsilon = 1
        current_box = get_next_location(current_box, action_index)
        shortest_path.append(current_box)
    return shortest_path

after_learn_path = get_shortest_path()
print(after_learn_path)
    </py-repl>
    <div class="max-w-2xl mx-auto my-10 p-5">
    <div class="flex space-x-4 mt-4">
        <button id="moveButton2" class="px-6 py-2 border rounded text-white bg-blue-500 hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
            ë¯¸ë¡œ íƒˆì¶œ ê²½ë¡œ ì‹œê°í™”í•˜ê¸°ë¡œ ì´ë™
        </button>
    </div>
    </div>
    <script>
        document.getElementById('moveButton2').addEventListener('click', function() {
          const targetElement = document.getElementById("interactive-maze");
          targetElement.scrollIntoView({ behavior: 'smooth' });
        });
    </script>

    <div class="container mx-auto px-4 py-8">
        <div class="bg-white shadow rounded-lg p-6">
            <p class="text-lg">
    ì°¸ê³  ìë£Œ : <br>
    1. PyTorchë¥¼ í™œìš©í•œ ê°•í™”í•™ìŠµ / ì‹¬ì¸µê°•í™”í•™ìŠµ ì‹¤ì „ ì…ë¬¸. (ì˜¤ê°€ì™€ ìœ íƒ€ë¡œ ì§€ìŒ, ì‹¬íš¨ì„­ ì˜®ê¹€) <br>
    2. Q-learning : A Complete Example in Python. (Dr. Daniel Soper) <a href="https://youtu.be/iKdlKYG78j4?si=tz-mk32g1yV-PbUX"> ìœ íŠœë¸Œ ë§í¬ </a>
            </p>
        </div>
        <div id="footer"></div>

        <script>
            $(function() {
                $("#header").load("header.html");
                $("#footer").load("footer.html");
            });
        </script>
    </div>

</body>
</html>

